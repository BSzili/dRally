#include "drally.h"

	extern byte ___1a112ch__VESA101_ACTIVESCREEN_PTR[];
	extern byte ___1a1124h__VESA101h_ScreenBufferA[];
	extern byte ___19eb50h[];
	extern byte ___1a54d0h[];

void ___2b318h(void);
void ___58c60h(void);
void ___13a98h_cdecl(dword);
void bpa_read(const char *, void *, const char *);
void bpk_decode2(void *, void *);
void ___12cb8h__VESA101_PRESENTSCREEN(void);
void ___3d1f0h(void);
byte ___5994ch(void);
void ___3d2bch(void);
void ___3d154h(const char * pal_name);
void __DISPLAY_SET_PALETTE_COLOR(dword b, dword g, dword r, dword n);

void menu___3d4f0h(void){

	long long ll_tmp;
	dword 	rr, gg, bb, nn;
	dword 	eax, ebx, ecx, edx, edi, esi, ebp;
	byte 	__esp[0x10+0xc];
	byte * 	esp = __esp+0x10;


		ecx = 0x4b000;
		ebp = 0x32;
		esi = D(___1a112ch__VESA101_ACTIVESCREEN_PTR);
		edi = D(___1a1124h__VESA101h_ScreenBufferA);
		edx = 0x640000;
		memcpy(edi, esi, ecx);
		___2b318h();
		D(esp) = edx;
___3d536h:
		___58c60h();
		esi = 2;
		edx = ebp;
		eax = ebp;
		edx = (int)edx>>0x1f;
		edx = (long long)(int)eax%(int)esi;
		if(edx == 0) goto ___3d554h;
		eax = 0;
		___13a98h_cdecl(eax);
___3d554h:
		esi = 0;
		edi = 0;
		D(esp+8) = esi;
		esi = D(esp);
___3d55fh:
		eax = 0;
		L(eax) = B(esp+8);
		nn = eax;
		edx = esi;
		eax = D(edi+___19eb50h);
		ll_tmp = (long long)(int)eax*(int)edx; edx = ll_tmp>>0x20; eax = ll_tmp;
		eax += 0x8000;
		edx += !!(eax < 0x8000);
		eax = (eax >> 0x10)|(edx << 0x10);
		eax += 0x8000;
		eax = (int)eax>>0x10;
		eax &= 0xff;
		rr = eax;
		edx = esi;
		eax = D(edi+___19eb50h+4);
		ll_tmp = (long long)(int)eax*(int)edx; edx = ll_tmp>>0x20; eax = ll_tmp;
		eax += 0x8000;
		edx += !!(eax < 0x8000);
		eax = (eax >> 0x10)|(edx << 0x10);
		eax += 0x8000;
		eax = (int)eax>>0x10;
		eax &= 0xff;
		gg = eax;
		edx = esi;
		eax = D(edi+___19eb50h+8);
		ll_tmp = (long long)(int)eax*(int)edx; edx = ll_tmp>>0x20; eax = ll_tmp;
		eax += 0x8000;
		edx += !!(eax < 0x8000);
		eax = (eax >> 0x10)|(edx << 0x10);
		eax += 0x8000;
		eax = (int)eax>>0x10;
		eax &= 0xff;
		bb = eax;
		__DISPLAY_SET_PALETTE_COLOR(bb, gg, rr, nn);
		edx = D(esp+8);
		edx++;
		edi += 0xc;
		D(esp+8) = edx;
		if((int)edx < 0x100) goto ___3d55fh;
		ebx = D(esp);
		ebx -= 0x20000;
		ebp--;
		D(esp) = ebx;
		if((int)ebp >= 0) goto ___3d536h;
		eax = "credit1.pal";
		ebx = "credit1.bpk";
		edx = ___1a54d0h;
		___3d154h(eax);
		eax = "MENU.BPA";
		bpa_read(eax, edx, ebx);
		ecx = D(___1a112ch__VESA101_ACTIVESCREEN_PTR);
		bpk_decode2(ecx, ___1a54d0h);
		___12cb8h__VESA101_PRESENTSCREEN();
		___3d1f0h();
___3d63dh:
		L(eax) = ___5994ch();
		if(L(eax) == 0) goto ___3d63dh;
		___3d2bch();
		eax = "credit2.pal";
		ebx = "credit2.bpk";
		edx = ___1a54d0h;
		___3d154h(eax);
		eax = "MENU.BPA";
		bpa_read(eax, edx, ebx);
		edi = D(___1a112ch__VESA101_ACTIVESCREEN_PTR);
		bpk_decode2(edi, ___1a54d0h);
		___12cb8h__VESA101_PRESENTSCREEN();
		___3d1f0h();
___3d684h:
		L(eax) = ___5994ch();
		if(L(eax) == 0) goto ___3d684h;
		___3d2bch();
		___2b318h();
		ecx = 0x4b000;
		esi = D(___1a1124h__VESA101h_ScreenBufferA);
		edi = D(___1a112ch__VESA101_ACTIVESCREEN_PTR);
		memcpy(edi, esi, ecx);
		ebp = 0;
		___12cb8h__VESA101_PRESENTSCREEN();
		D(esp+4) = ebp;
___3d6c3h:
		___58c60h();
		esi = 2;
		edx = ebp;
		eax = ebp;
		edx = (int)edx>>0x1f;
		edx = (long long)(int)eax%(int)esi;
		if(edx == 0) goto ___3d6e1h;
		eax = 0;
		___13a98h_cdecl(eax);
___3d6e1h:
		esi = D(esp+4);
		ecx = 0;
		edi = 0;
		D(esp+8) = ecx;
___3d6edh:
		eax = 0;
		L(eax) = B(esp+8);
		nn = eax;
		edx = esi;
		eax = D(edi+___19eb50h);
		ll_tmp = (long long)(int)eax*(int)edx; edx = ll_tmp>>0x20; eax = ll_tmp;
		eax += 0x8000;
		edx += !!(eax < 0x8000);
		eax = (eax >> 0x10)|(edx << 0x10);
		eax += 0x8000;
		eax = (int)eax>>0x10;
		eax &= 0xff;
		rr = eax;
		edx = esi;
		eax = D(edi+___19eb50h+4);
		ll_tmp = (long long)(int)eax*(int)edx; edx = ll_tmp>>0x20; eax = ll_tmp;
		eax += 0x8000;
		edx += !!(eax < 0x8000);
		eax = (eax >> 0x10)|(edx << 0x10);
		eax += 0x8000;
		eax = (int)eax>>0x10;
		eax &= 0xff;
		gg = eax;
		edx = esi;
		eax = D(edi+___19eb50h+8);
		ll_tmp = (long long)(int)eax*(int)edx; edx = ll_tmp>>0x20; eax = ll_tmp;
		eax += 0x8000;
		edx += !!(eax < 0x8000);
		eax = (eax >> 0x10)|(edx << 0x10);
		eax += 0x8000;
		eax = (int)eax>>0x10;
		eax &= 0xff;
		bb = eax;
		__DISPLAY_SET_PALETTE_COLOR(bb, gg, rr, nn);
		eax = D(esp+8);
		eax++;
		edi += 0xc;
		D(esp+8) = eax;
		if((int)eax < 0x100) goto ___3d6edh;
		edx = D(esp+6);
		edx += 2;
		ebp++;
		W(esp+6) = X(edx);
		if((int)ebp < 0x32) goto ___3d6c3h;
		return;
}

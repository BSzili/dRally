#include "drally.h"

	extern byte ___1a1ef8h[];
	extern byte ___1a01fch[];
	extern byte ___1a1ef0h[];
	extern byte ___1a0218h[];
	extern byte ___1854bch[];
	extern byte ___24cc54h[];
	extern byte ___1a0214h[];
	extern byte ___1a0210h[];
	extern byte ___185a38h[];
	extern byte ___1854a4h[];
	extern byte ___1822aeh[];
	extern byte ___1822b6h[];
	extern byte ___1822beh[];
	extern byte ___1822c6h[];
	extern byte ___1822ceh[];
	extern byte ___1822d6h[];
	extern byte ___1822deh[];
	extern byte ___1822e6h[];
	extern byte ___1a0a50h[];
	extern byte ___1a0170h_PriceMines[];
	extern byte ___1854b8h[];
	extern byte ___1a023ch[];
	extern byte ___1a0a54h[];
	extern byte ___1a0174h_PriceSpikedBumpers[];
	extern byte ___1a0240h[];
	extern byte ___1a0a58h[];
	extern byte ___1a0178h_PriceRocketFuel[];
	extern byte ___1a0244h[];
	extern byte ___1a0a5ch[];
	extern byte ___1a017ch_PriceSabotage[];
	extern byte ___1a0248h[];
	extern byte ___1a01ech[];
	extern byte ___1820b0h[];
	extern byte ___180130h[];
	extern byte ___18224ch[];
	extern byte ___182270h[];
	extern byte ___182294h[];
	extern byte ___1854a8h[];
	extern byte ___19bd60h[];
	extern byte ___196adch[];
	extern byte ___1a0224h[];
	extern byte ___185a20h[];

void ___31008h(void);
void ___3266ch(void);
void ___33010h_cdecl(dword A1);
void ___13094h_cdecl(const char * A1, dword A2);
void ___13248h_cdecl(dword, dword ,dword, dword, dword);
void ___2db88h(void);
void ___2da10h(void);
void ___2d898h(void);
void ___2d728h(void);
void ___2d0ech_cdecl(dword);
dword ___28ab4h_cdecl(dword);
void ___2d6a0h(void);
void ___2d618h(void);
void ___25330h(void);
void ___12cb8h__VESA101_PRESENTSCREEN(void);
void ___26fach(void);
void dRally_Sound_pushEffect(byte channel, byte n, dword unk, dword a0, dword a1, dword a2);

void underground___2e350h(void){

	dword 	eax, ebx, ecx, edx, edi, esi, ebp;
	byte 	esp[0xc];


		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		L(edx) = 5;
		H(edx) = B(eax*4+___1a01fch);
		L(edx) -= H(edx);
		B(esp+8) = L(edx);
		if(D(eax*4+___1a01fch) != 0) goto ___2e395h;
		B(esp+8) = 4;
___2e395h:
		eax = D(___1a1ef0h);

		switch(eax){
		case 0: goto ___2e3abh;
		case 1: goto ___2e7adh;
		case 2: goto ___2e885h;
		case 3: goto ___2e959h;
		case 4: goto ___2ea30h;
		case 5: goto ___2eb07h;
		default:
			goto ___2ec5eh;
		}

___2e3abh:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		eax <<= 2;
		if(D(eax+___1a0218h) != 0xffffffff) goto ___2e4f7h;
		if(D(eax+___1a01fch) == 0) goto ___2e4f7h;
		eax = 1;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		edx = 0x1d;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854bch), 0x8000);
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		ebx = 1;
		eax -= edx;
		edx = edx^edx;
		eax <<= 2;
		L(edx) = B(esp+8);
		D(eax+___1a0218h) = ebx;
		D(eax+___1a0214h) = edx;
		if(L(edx)) goto ___2e43bh;
		D(eax+___1a0210h) += 0x2ee0;
___2e43bh:
		if(B(esp+8) != 1) goto ___2e461h;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a0210h) += 0x2328;
___2e461h:
		if(B(esp+8) != 2) goto ___2e487h;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a0210h) += 0x1770;
___2e487h:
		if(B(esp+8) != 3) goto ___2e4adh;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a0210h) += 0xbb8;
___2e4adh:
		if(B(esp+8) != 4) goto ___2e4d3h;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a0210h) += 0x5dc;
___2e4d3h:
		ebx = 0x136;
		___26fach();
		D(___185a38h) = ebx;
		___25330h();
		___12cb8h__VESA101_PRESENTSCREEN();
		return;
___2e4f7h:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		eax <<= 2;
		if(D(eax+___1a0218h) != 0xffffffff) goto ___2e558h;
		if(D(eax+___1a01fch) != 0) goto ___2e558h;
		edx = 0x17;
		eax = 2;
		esi = D(___1854a4h);
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		edi = 0x136;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, esi, 0x8000);
		D(___185a38h) = edi;
		___2d618h();
		___12cb8h__VESA101_PRESENTSCREEN();
___2e558h:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		eax <<= 2;
		ebp = D(eax+___1a0218h);
		if(ebp == 0xffffffff) goto ___2ec5eh;
		edx = D(eax+___1a0214h);
		L(ebx) = 0;
		if(edx) goto ___2e5aeh;
		eax = ebp-1;
		D(esp) = eax;
		FPUSH((int)D(esp));
		ST(0) = ST(0)/F64(___1822aeh);
		ST(0) = ST(0)*F64(___1822b6h);
		ST(0) = ST(0)+F64(___1822beh);
		ST(0) = (int)ST(0);
		D(esp+4) = (int)FPOP();
___2e5aeh:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		eax <<= 2;
		ecx = D(eax+___1a0214h);
		if(ecx != 1) goto ___2e5f9h;
		eax = D(eax+___1a0218h);
		eax -= ecx;
		D(esp) = eax;
		FPUSH((int)D(esp));
		ST(0) = ST(0)/F64(___1822aeh);
		ST(0) = ST(0)*F64(___1822c6h);
		ST(0) = ST(0)+F64(___1822ceh);
		ST(0) = (int)ST(0);
		D(esp+4) = (int)FPOP();
___2e5f9h:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		eax <<= 2;
		if(D(eax+___1a0214h) != 2) goto ___2e641h;
		eax = D(eax+___1a0218h);
		eax--;
		D(esp) = eax;
		FPUSH((int)D(esp));
		ST(0) = ST(0)/F64(___1822aeh);
		ST(0) = ST(0)*F64(___1822d6h);
		ST(0) = ST(0)+F64(___1822b6h);
		ST(0) = (int)ST(0);
		D(esp+4) = (int)FPOP();
___2e641h:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		eax <<= 2;
		if(D(eax+___1a0214h) != 3) goto ___2e689h;
		eax = D(eax+___1a0218h);
		eax--;
		D(esp) = eax;
		FPUSH((int)D(esp));
		ST(0) = ST(0)/F64(___1822aeh);
		ST(0) = ST(0)*F64(___1822deh);
		ST(0) = ST(0)+F64(___1822d6h);
		ST(0) = (int)ST(0);
		D(esp+4) = (int)FPOP();
___2e689h:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		eax <<= 2;
		if(D(eax+___1a0214h) != 4) goto ___2e6d1h;
		eax = D(eax+___1a0218h);
		eax--;
		D(esp) = eax;
		FPUSH((int)D(esp));
		ST(0) = ST(0)/F64(___1822aeh);
		ST(0) = ST(0)*F64(___1822e6h);
		ST(0) = ST(0)+F64(___1822deh);
		ST(0) = (int)ST(0);
		D(esp+4) = (int)FPOP();
___2e6d1h:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		edx = D(esp+4);
		if((int)edx <= (int)D(eax*4+___1a0210h)) goto ___2e6f4h;
		L(ebx) = 1;
___2e6f4h:
		if(L(ebx)) goto ___2e780h;
		edx = 0x1d;
		eax = 1;
		ebx = ebx^ebx;
		ecx = D(___24cc54h);
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854bch), 0x8000);
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		edx = 4*eax;
		edi = 0xffffffff;
		D(edx+___1a0218h) = edi;
		eax = D(esp+4);
		esi = D(edx+___1a0210h);
		D(edx+___1a0214h) = edi;
		esi -= eax;
		eax = 0x136;
		D(edx+___1a0210h) = esi;
		D(___185a38h) = eax;
		___2d6a0h();
		___25330h();
		___12cb8h__VESA101_PRESENTSCREEN();
		return;
___2e780h:
		edx = 0x17;
		eax = 2;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854a4h), 0x8000);
		return;
___2e7adh:
		ebp = D(___1a0a50h);
		if(ebp != 1) goto ___2e7c6h;
		eax = D(___1a0170h_PriceMines);
		eax = ___28ab4h_cdecl(eax);
		if(eax == 0) goto ___2e7f3h;
___2e7c6h:
		edx = 0x17;
		edi = D(___1854a4h);
		eax = 2;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, edi, 0x8000);
		return;
___2e7f3h:
		edx = 0x1c;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		eax = ebp;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854b8h), 0x8000);
		edx = edx^edx;
		D(___1a0a50h) = edx;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		edx = D(___1a0170h_PriceMines);
		D(eax*4+___1a0210h) -= edx;
		___2d728h();
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a023ch) = 0x8;
		eax = eax^eax;
		esi = 0x136;
		___2d0ech_cdecl(eax);
		D(___185a38h) = esi;
		___25330h();
		___12cb8h__VESA101_PRESENTSCREEN();
		return;
___2e885h:
		ebp = D(___1a0a54h);
		if(ebp != 1) goto ___2e89eh;
		eax = D(___1a0174h_PriceSpikedBumpers);
		eax = ___28ab4h_cdecl(eax);
		if(eax == 0) goto ___2e8cbh;
___2e89eh:
		edx = 0x17;
		edi = D(___1854a4h);
		eax = 2;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, edi, 0x8000);
		return;
___2e8cbh:
		edx = 0x1c;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		eax = ebp;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854b8h), 0x8000);
		edx = edx^edx;
		D(___1a0a54h) = edx;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		edx = D(___1a0174h_PriceSpikedBumpers);
		D(eax*4+___1a0210h) -= edx;
		___2d898h();
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a0240h) = ebp;
		eax = ebp;
		esi = 0x136;
		___2d0ech_cdecl(eax);
		D(___185a38h) = esi;
		___25330h();
		___12cb8h__VESA101_PRESENTSCREEN();
		return;
___2e959h:
		ebp = D(___1a0a58h);
		if(ebp != 1) goto ___2e972h;
		eax = D(___1a0178h_PriceRocketFuel);
		eax = ___28ab4h_cdecl(eax);
		if(eax == 0) goto ___2e99fh;
___2e972h:
		edx = 0x17;
		edi = D(___1854a4h);
		eax = 2;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, edi, 0x8000);
		return;
___2e99fh:
		edx = 0x1c;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		eax = ebp;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854b8h), 0x8000);
		edx = edx^edx;
		D(___1a0a58h) = edx;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		edx = D(___1a0178h_PriceRocketFuel);
		D(eax*4+___1a0210h) -= edx;
		___2da10h();
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a0244h) = ebp;
		eax = 2;
		esi = 0x136;
		___2d0ech_cdecl(eax);
		D(___185a38h) = esi;
		___25330h();
		___12cb8h__VESA101_PRESENTSCREEN();
		return;
___2ea30h:
		ebp = D(___1a0a5ch);
		if(ebp != 1) goto ___2ea49h;
		eax = D(___1a017ch_PriceSabotage);
		eax = ___28ab4h_cdecl(eax);
		if(eax == 0) goto ___2ea76h;
___2ea49h:
		edx = 0x17;
		edi = D(___1854a4h);
		eax = 2;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, edi, 0x8000);
		return;
___2ea76h:
		edx = 0x1c;
		ecx = D(___24cc54h);
		ebx = ebx^ebx;
		eax = ebp;
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854b8h), 0x8000);
		edx = edx^edx;
		D(___1a0a5ch) = edx;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		edx = D(___1a017ch_PriceSabotage);
		D(eax*4+___1a0210h) -= edx;
		___2db88h();
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		D(eax*4+___1a0248h) = ebp;
		eax = 3;
		esi = 0x136;
		___2d0ech_cdecl(eax);
		D(___185a38h) = esi;
		___25330h();
		___12cb8h__VESA101_PRESENTSCREEN();
		return;
___2eb07h:
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		if(D(eax*4+___1a01ech) != 0x64) goto ___2ebc1h;
		ecx = 0x77;
		ebx = 0x180;
		edx = 0x72;
		eax = 0x90;
		___13248h_cdecl(eax, edx, ebx, ecx, 1);
		edx = 0x136aa;
		eax = ___1820b0h;
		___13094h_cdecl(eax, edx);
		edx = 0x15eaa;
		eax = ___180130h;
		___13094h_cdecl(eax, edx);
		edx = 0x186aa;
		eax = ___18224ch;
		___13094h_cdecl(eax, edx);
		edx = 0x1aeaa;
		eax = ___182270h;
		___13094h_cdecl(eax, edx);
		edx = 0x1d6aa;
		eax = ___182294h;
		ebx = ebx^ebx;
		___13094h_cdecl(eax, edx);
		___12cb8h__VESA101_PRESENTSCREEN();
		edi = D(___1854a4h);
		edx = 0x17;
		eax = 2;
		ecx = D(___24cc54h);
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, edi, 0x8000);
		return;
___2ebc1h:
		edx = 0x18;
		eax = 1;
		ebx = ebx^ebx;
		ecx = D(___24cc54h);
		dRally_Sound_pushEffect(eax, edx, ebx, ecx, D(___1854a8h), 0x8000);
		if(D(___19bd60h) == 0) goto ___2ebf9h;
		eax = D(___196adch);
		___33010h_cdecl(eax);
		goto ___2ec49h;
___2ebf9h:
		ebp = D(___1a1ef8h);
		L(eax) = 0;
		ecx = ecx^ecx;
___2ec03h:
		ebx = ebx^ebx;
		L(ebx) = L(eax);
		edx = 0x6c*ebx;
		edi = D(edx+___1a0224h);
		if((int)ecx >= (int)edi) goto ___2ec1ah;
		if(ebx == ebp) goto ___2ec1ah;
		ecx = edi;
___2ec1ah:
		L(eax)++;
		if(L(eax) < 0x14) goto ___2ec03h;
		edx = D(___1a1ef8h);
		eax = 8*edx;
		eax -= edx;
		eax <<= 2;
		eax -= edx;
		if((int)ecx >= (int)D(4*eax+___1a0224h)) goto ___2ec44h;
		___31008h();
		goto ___2ec49h;
___2ec44h:
		___3266ch();
___2ec49h:
		edx = 1;
		eax = 4;
		D(___185a20h) = edx;
		D(___1a1ef0h) = eax;
___2ec5eh:
		return;
}

#include "drally.h"
#include "drally_structs_free.h"

	extern __BYTE__ ___243878h[];
	extern __BYTE__ MY_CAR_IDX[];
	extern __BYTE__ ___1e6ed0h[];
	extern __POINTER__ ___24e4c0h;
	extern __BYTE__ ___1de580h[];
	extern __BYTE__ SUPERGLOBAL___243cd0h[];
	extern __BYTE__ SUPERGLOBAL___243cach[];
	extern __DWORD__ CONNECTION_TYPE;

void ___618c4h(void);
void race___40164h(void);

void race___44304h(void){

	__DWORD__ 		eax, ebx, ecx, edx, edi, esi, ebp;
	__POINTER__ 	esip;
	__BYTE__ 		esp[8];
	struct_35e_t * 	s_35e;


	s_35e = (struct_35e_t *)___1e6ed0h;
	eax = getCounter(3);

	if((int)eax >= (int)D(___243878h)){

		edx = 0x35e*D(MY_CAR_IDX);
		L(ecx) = s_35e[edx/0x35e].__108;
		L(eax) = s_35e[edx/0x35e].__10a&0xff;
		L(ecx) <<= 4;
		L(eax) <<= 3;
		L(ecx) += L(eax);
		X(ebx) = W(___24e4c0h);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = 0xfe;
		X(ebx) = W(___24e4c0h);
		ebx++;
		W(___24e4c0h) = X(ebx);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		esip = ___24e4c0h+ebx;
		L(ebx) = B(MY_CAR_IDX);
		B(esip+4) = L(ebx);
		esi = D(MY_CAR_IDX);
		ebx = 8*esi;
		ebx += esi;
		ebx <<= 2;
		ebx += esi;
		X(esi) = W(___24e4c0h);
		esi++;
		ebx <<= 2;
		W(___24e4c0h) = X(esi);
		esi = D(ebx+___1de580h+0x18);
		esi = (int)esi>>4;
		D(esp) = esi;
		X(esi) = W(___24e4c0h);
		H(ecx) = B(esp);
		esi &= 0xfff;
		esi &= 0xffff;
		B(esi+___24e4c0h+4) = H(ecx);
		X(edi) = W(___24e4c0h);
		edi++;
		W(___24e4c0h) = X(edi);
		esi = D(ebx+___1de580h+0x18);
		esi = (int)esi>>0xc;
		D(esp) = esi;
		esi = edi;
		H(ecx) = B(esp);
		esi &= 0xfff;
		esi &= 0xffff;
		B(esi+___24e4c0h+4) = H(ecx);
		W(___24e4c0h)++;
		esi = D(ebx+___1de580h+0x34);
		esi = (int)esi>>0xa;
		D(esp) = esi;
		X(esi) = W(___24e4c0h);
		H(ecx) = B(esp);
		esi &= 0xfff;
		esi &= 0xffff;
		B(esi+___24e4c0h+4) = H(ecx);
		X(edi) = W(___24e4c0h);
		edi++;
		W(___24e4c0h) = X(edi);
		esi = D(ebx+___1de580h+0x30);
		esi = (int)esi>>0xa;
		D(esp) = esi;
		esi = edi;
		H(ecx) = B(esp);
		esi &= 0xfff;
		esi &= 0xffff;
		B(esi+___24e4c0h+4) = H(ecx);
		X(esi) = W(___24e4c0h);
		esi++;
		W(___24e4c0h) = X(esi);
		esi &= 0xfff;
		esi &= 0xffff;
		L(ebx) = B(ebx+___1de580h+0x50);
		B(esi+___24e4c0h+4) = L(ebx);
		X(edi) = W(___24e4c0h);
		edi++;
		ebx = edi;
		W(___24e4c0h) = X(edi);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = L(ecx);
		X(ebx) = W(___24e4c0h);
		ebx++;
		W(___24e4c0h) = X(ebx);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		esip = ___24e4c0h+ebx;
		L(ebx) = s_35e[edx/0x35e].__0&0xff;
		B(esip+4) = L(ebx);
		W(___24e4c0h)++;
		D(esp) = (int)(double)s_35e[edx/0x35e].XLocation;
		ebx = D(esp);
		W(esp+4) = X(ebx);
		ebx = D(esp+2);
		ebx = (int)ebx>>0x10;
		ebx = (int)ebx>>8;
		L(ecx) = L(ebx);
		X(ebx) = W(___24e4c0h);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = L(ecx);
		X(esi) = W(___24e4c0h);
		esi++;
		W(___24e4c0h) = X(esi);
		D(esp) = (int)(double)s_35e[edx/0x35e].XLocation;
		ebx = D(esp);
		esi &= 0xfff;
		esi &= 0xffff;
		B(esi+___24e4c0h+4) = L(ebx);
		X(edi) = W(___24e4c0h);
		edi++;
		W(___24e4c0h) = X(edi);
		D(esp) = (int)(double)s_35e[edx/0x35e].YLocation;
		ebx = D(esp);
		W(esp+4) = X(ebx);
		ebx = D(esp+2);
		ebx = (int)ebx>>0x10;
		ebx = (int)ebx>>8;
		L(ecx) = L(ebx);
		ebx = edi;
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = L(ecx);
		W(___24e4c0h)++;
		D(esp) = (int)(double)s_35e[edx/0x35e].YLocation;
		ebx = D(esp);
		L(ecx) = L(ebx);
		X(ebx) = W(___24e4c0h);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = L(ecx);
		W(___24e4c0h)++;
		D(esp) = (int)(double)s_35e[edx/0x35e].__14e;
		ebx = D(esp);
		W(esp+4) = X(ebx);
		ebx = D(esp+2);
		ebx = (int)ebx>>0x10;
		ebx = (int)ebx>>8;
		L(ecx) = L(ebx);
		X(ebx) = W(___24e4c0h);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = L(ecx);
		X(esi) = W(___24e4c0h);
		esi++;
		W(___24e4c0h) = X(esi);
		D(esp) = (int)(double)s_35e[edx/0x35e].__14e;
		ebx = D(esp);
		ecx = ebx;
		ebx = esi;
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = L(ecx);
		X(edi) = W(___24e4c0h);
		edi++;
		W(___24e4c0h) = X(edi);
		D(esp) = (int)(double)s_35e[edx/0x35e].__152;
		ebx = D(esp);
		W(esp+4) = X(ebx);
		ebx = D(esp+2);
		ebx = (int)ebx>>0x10;
		ebx = (int)ebx>>8;
		L(ecx) = L(ebx);
		ebx = edi;
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(ebx+___24e4c0h+4) = L(ecx);
		W(___24e4c0h)++;
		D(esp) = (int)(double)s_35e[edx/0x35e].__152;
		ebx = D(esp);
		L(ecx) = L(ebx);
		X(ebx) = W(___24e4c0h);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(___24e4c0h+ebx+4) = L(ecx);
		X(ecx) = W(___24e4c0h);
		ecx++;
		ebx = ecx;
		W(___24e4c0h) = X(ecx);
		H(ebx) &= 0xf;
		ebx &= 0xffff;
		B(___24e4c0h+ebx+4) = s_35e[edx/0x35e].ImgIndex&0xff;
		X(esi) = W(___24e4c0h);
		esi++;
		edx = esi;
		W(___24e4c0h) = X(esi);
		H(edx) &= 0xf;
		edx &= 0xffff;
		B(___24e4c0h+edx+4) = 0xff;
		X(edi) = W(___24e4c0h);
		edi++;
		W(___24e4c0h) = X(edi);
		D(SUPERGLOBAL___243cd0h) = 1;
		___618c4h();
		
		if((int)D(SUPERGLOBAL___243cach) > 0){
		
			race___40164h();
			D(SUPERGLOBAL___243cach) = 0;
		}

		D(SUPERGLOBAL___243cd0h) = 0;

		if(CONNECTION_TYPE == 2) D(___243878h) = getCounter(3)+1;
		if(CONNECTION_TYPE == 1) D(___243878h) = getCounter(3)+2;
		if((CONNECTION_TYPE == 3)||(CONNECTION_TYPE == 4)) D(___243878h) = getCounter(3)+3;
	}
}
